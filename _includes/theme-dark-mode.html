<!-- HTML, CSS å’Œ JavaScript ä»£ç  -->

<!-- 1. å¿…è¦çš„ CSS æ ·å¼ -->
<style>
  /* å¼ºåˆ¶éšè— darkmode.js åº“è‡ªå¸¦çš„æµ®åŠ¨æŒ‰é’® */
  .darkmode-toggle {
    display: none !important;
  }

  /* è‡ªå®šä¹‰åˆ‡æ¢æŒ‰é’®çš„å®¹å™¨æ ·å¼ */
  #custom-darkmode-toggle {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 22px;
    height: 22px;
    padding: 0;
    background-color: transparent;
    border: none;
    cursor: pointer;
    /* è®©SVGå›¾æ ‡é¢œè‰²ç»§æ‰¿å½“å‰æ–‡æœ¬é¢œè‰²ï¼Œä»¥ä¾¿æ›´å¥½åœ°é€‚åº”æ‚¨çš„ä¸»é¢˜ */
    color: inherit; 
  }

  #custom-darkmode-toggle svg {
    width: 100%;
    height: 100%;
    fill: currentColor; /* ä½¿ç”¨ currentColor ç»§æ‰¿çˆ¶å…ƒç´ çš„ color å±æ€§ */
  }

  /* é»˜è®¤çŠ¶æ€ä¸‹ï¼ˆäº®è‰²æ¨¡å¼ï¼‰ï¼Œæ˜¾ç¤ºå¤ªé˜³ï¼Œéšè—æœˆäº® */
  .sun-icon {
    display: block;
  }
  .moon-icon {
    display: none;
  }

  /* å½“ body æœ‰ .darkmode--activated ç±»æ—¶ï¼ˆæš—è‰²æ¨¡å¼ï¼‰ï¼Œéšè—å¤ªé˜³ï¼Œæ˜¾ç¤ºæœˆäº® */
  .darkmode--activated .sun-icon {
    display: none;
  }
  .darkmode--activated .moon-icon {
    display: block;
  }
</style>

<!-- 2. å¼•å…¥ darkmode.min.js åº“ -->
<!-- è¯·ç¡®ä¿è¿™é‡Œçš„è·¯å¾„æ˜¯æ­£ç¡®çš„ -->
<script src="/assets/darkmode-js.min.js"></script>

<!-- 3. åˆå§‹åŒ–å’Œæ§åˆ¶é€»è¾‘ -->
<script>
  // ç­‰å¾…æ–‡æ¡£å®Œå…¨åŠ è½½
  document.addEventListener('DOMContentLoaded', function () {
    
    // (1) å®šä¹‰ darkmode.js çš„åˆå§‹åŒ–å‚æ•°
    const options = {
      saveInCookies: true,       // ä¿å­˜ç”¨æˆ·é€‰æ‹©åˆ° cookie
      autoMatchOsTheme: false,   // ä¸è‡ªåŠ¨åŒ¹é…æ“ä½œç³»ç»Ÿä¸»é¢˜
      label: 'ğŸŒ“' // è¿™ä¸ªæ ‡ç­¾è™½ç„¶ä¸ä¼šæ˜¾ç¤ºï¼Œä½†åº“å†…éƒ¨å¯èƒ½éœ€è¦
    };

    // (2) åˆå§‹åŒ– darkmode å®ä¾‹
    const darkmode = new Darkmode(options);

    // æ³¨æ„ï¼šæˆ‘ä»¬ **ä¸** è°ƒç”¨ darkmode.showWidget()ï¼Œå› ä¸ºæˆ‘ä»¬ä¸æƒ³æ˜¾ç¤ºé»˜è®¤çš„æµ®åŠ¨æŒ‰é’®ã€‚
    // æˆ‘ä»¬å°†æ‰‹åŠ¨æ§åˆ¶åˆ‡æ¢åŠŸèƒ½ã€‚

    // (3) è·å–æ‚¨åœ¨ header ä¸­è®¾ç½®çš„å ä½ç¬¦å…ƒç´ 
    const placeholder = document.getElementById('darkmode-placeholder');

    if (placeholder) {
      // (4) åˆ›å»ºå¹¶æ³¨å…¥æˆ‘ä»¬çš„è‡ªå®šä¹‰ SVG æŒ‰é’®
      const toggleButtonHTML = `
        <button id="custom-darkmode-toggle" aria-label="Toggle dark mode">
          <svg class="sun-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="22px" height="22px">
            <path d="M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM12 15c-1.65 0-3-1.35-3-3s1.35-3 3-3 3 1.35 3 3-1.35 3-3 3zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zM12 20c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zM1 11h2v2H1zM21 11h2v2h-2zM11 1v2h2V1zM11 21v2h2v-2zM4.22 4.22l1.42 1.42 1.41-1.41L5.63 2.81zM18.36 18.36l-1.42-1.42-1.41 1.41 1.41 1.42zM2.81 18.36l1.41-1.41 1.42 1.42L4.22 19.78zM19.78 4.22l-1.41 1.42-1.42-1.42 1.42-1.41z"/>
          </svg>
          <svg class="moon-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="22px" height="22px">
            <path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9c.83 0 1.62-.11 2.36-.31-3.12-.99-5.36-3.95-5.36-7.44 0-4.24 3.42-7.66 7.66-7.66.39 0 .78.04 1.15.11C16.88 3.63 14.54 3 12 3z"/>
          </svg>
        </button>
      `;
      placeholder.innerHTML = toggleButtonHTML;

      // (5) ä¸ºæˆ‘ä»¬æ–°åˆ›å»ºçš„æŒ‰é’®æ·»åŠ ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨
      const toggleButton = document.getElementById('custom-darkmode-toggle');
      if (toggleButton) {
        toggleButton.addEventListener('click', function() {
          darkmode.toggle(); // è°ƒç”¨åº“çš„åˆ‡æ¢æ–¹æ³•
        });
      }
    } else {
      console.warn('Darkmode placeholder with ID "darkmode-placeholder" was not found.');
    }
  });
</script>