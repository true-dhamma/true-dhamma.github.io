<!-- /_includes/video-section-template.html -->
<section id="section-{{ section_id }}" class="video-category-section">
  <!-- 这里的标题其实会被 switchCategory 动态更新到顶部的 h1，这里可以隐藏或者保留作为区块头 -->
  <!-- <h2 class="typeset">{{ section_title }}</h2> -->
  
  <div class="video-grid">
    {% for v_filename in current_videos %}
      
      {% assign video_info = nil %}
      {% for v in site.data.video.library %}
        {% if v.filename == v_filename %}
          {% assign video_info = v %}
          {% break %}
        {% endif %}
      {% endfor %}

      {% if video_info %}
        {% assign filename_no_ext = video_info.filename | split: '.' | first %}
        <!-- 简单的字符串拼接，实际加载由 JS 处理 fallback -->
        {% assign thumb_url = cover_base_url | append: filename_no_ext | append: ".jpg" %} 

        <!-- 
           关键修复：
           1. 所有数据放在 data-* 属性中。
           2. onclick 传递 'this'，JS 函数接收这个 DOM 元素读取 dataset。
        -->
        <div class="video-card typeset" 
             data-filename="{{ video_info.filename }}"
             data-title="{{ video_info.title | escape }}"
             data-post-url="{{ video_info.post_url }}"
             data-post-title="{{ video_info.post_title | escape }}"
             onclick="openVideo(this)">
             
          <div class="video-thumbnail-wrapper">
            <img 
              src="{{ thumb_url }}" 
              alt="{{ video_info.title | escape }}" 
              class="video-thumbnail" 
              loading="lazy"
              onerror="this.src='{{ fallback_cover }}'"
            >
            <div class="play-icon-overlay"></div>
          </div>
          
          <div class="video-info">
            <!-- 强制使用 h5 -->
            <h5 class="video-card-title">{{ video_info.title }}</h5>
          </div>
        </div>
      {% endif %}

    {% endfor %}
  </div>
</section>