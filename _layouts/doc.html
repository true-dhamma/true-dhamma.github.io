---
layout: default
---

<!-- 1. 引入 AlbeMic 主题的页眉 -->
{% include site-header.html %}

<!-- ======================================================================= -->
<!-- SEO 描述覆盖 (只在本布局生效) -->
<!-- 1. 我们先用 Liquid 生成一个干净的摘要 -->
{% capture auto_description %}
  {{ content | strip_html | strip_newlines | truncate: 160 }}
{% endcapture %}

<!-- 
  2. 然后，我们把这个摘要赋值给 page.description 变量。
     jekyll-seo-tag 插件会优先使用这个变量。
     我们只在页面本身没有定义 description 时才这样做，以保留手动设置的灵活性。
-->
{% unless page.description %}
  {% assign page.description = auto_description %}
{% endunless %}
<!-- ======================================================================= -->

<!-- ======================================================================= -->
<!-- 2. 内联 CSS 样式 -->
<!-- ======================================================================= -->
<style>
  /* 全局布局容器 */
  .doc-layout {
    display: grid;
    grid-template-columns: 1fr; /* 移动端优先，默认为单栏 */
    gap: 2.5rem;
    max-width: 1200px; /* 或者你主题的 container 宽度 */
    margin: 0 auto;
    align-items: flex-start;
  }

  /* 桌面端 (中等屏幕) 两栏布局 */
  @media (min-width: 768px) {
    .doc-layout {
      grid-template-columns: 240px 1fr;
    }
  }

  /* 桌面端 (大屏幕) 三栏布局 */
  @media (min-width: 1024px) {
    .doc-layout {
      grid-template-columns: 240px 1fr 240px;
    }
  }

  /* 左右侧边栏通用样式 */
  .doc-sidebar-left,
  .doc-sidebar-right {
    position: sticky;
    top: 2rem;
    height: calc(100vh - 4rem);
    overflow-y: auto;
  }
  
  /* 左侧边栏 (章节导航) */
  .doc-sidebar-left {
    display: none; /* 移动端默认隐藏 */
  }
  @media (min-width: 768px) {
    .doc-sidebar-left {
      display: block; /* 在桌面端显示 */
    }
  }
  .doc-sidebar-left nav h3 {
    margin-top: 0;
    font-size: 1.1em;
    padding-bottom: 0.5rem;
    border-bottom: 1px solid #eee;
  }
  .doc-sidebar-left nav ul { list-style: none; padding: 0; margin: 0; }
  .doc-sidebar-left nav li a {
    display: block; padding: 0.5rem 1rem 0.5rem 0.75rem;
    text-decoration: none; border-left: 4px solid transparent; transition: all 0.2s ease;
    color: inherit; /* 继承主题颜色 */
  }
  .doc-sidebar-left nav li a:hover { background-color: #f8f9fa; border-left-color: #ddd; }
  .doc-sidebar-left nav li.active a {
    font-weight: 600;
    color: #007bff; /* 高亮颜色，你可以根据你的主题修改 */
    border-left-color: #007bff;
  }
  
  /* 右侧边栏 (页面内 TOC) */
  .doc-sidebar-right {
    display: none; /* 移动端和中等屏幕隐藏 */
    font-size: 0.875em;
  }
  @media (min-width: 1024px) {
    .doc-sidebar-right {
      display: block; /* 仅在大屏幕上显示 */
    }
  }
  .doc-sidebar-right .doc-toc-nav h4 {
    margin-top: 0; font-size: 0.9em; font-weight: bold;
    text-transform: uppercase; color: #6c757d;
  }
  .doc-sidebar-right .toc-list, .doc-sidebar-right .toc-sublist { list-style: none; padding-left: 0; }
  .doc-sidebar-right .toc-sublist { padding-left: 1rem; }
  .doc-sidebar-right .toc-link {
    display: block; padding: 0.25rem 0; text-decoration: none;
    color: #6c757d; transition: all 0.2s ease-in-out;
  }
  .doc-sidebar-right .toc-link:hover { color: #343a40; }
  .doc-sidebar-right .toc-link.is-active {
    color: #007bff; font-weight: 600; transform: translateX(5px);
  }
  
  /* 中间主内容区 */
  .doc-main-content .article {
    padding: 0;
  }

  /* 翻页导航 */
  .doc-pagination {
    display: flex; justify-content: space-between;
    margin-top: 3rem; padding-top: 1.5rem; border-top: 1px solid #eee;
  }
  .doc-pagination a { max-width: 48%; }
</style>

<!-- 
  =======================================================================
  动态获取当前 Collection 的内容
  =======================================================================
-->
{% assign current_collection_name = page.collection %}
{% assign documents_in_collection = site[current_collection_name] %}

<main class="main  container">
  <div class="doc-layout">
    
    <!-- ======================================================= -->
    <!-- 左侧边栏 -->
    <!-- ======================================================= -->
    <aside class="doc-sidebar-left">
      <nav class="doc-chapters-nav">
        <h3>{{ site.collections[current_collection_name].title | default: current_collection_name | capitalize }}</h3>
        
        {% if documents_in_collection and documents_in_collection.size > 0 %}
          <ul>
            {% assign sorted_docs = documents_in_collection | sort: 'order' %}
            {% for doc in sorted_docs %}
              <li {% if page.url == doc.url %}class="active"{% endif %}>
                <a href="{{ doc.url | relative_url }}">{{ doc.title }}</a>
              </li>
            {% endfor %}
          </ul>
        {% endif %}
      </nav>
    </aside>

    <!-- ======================================================= -->
    <!-- 中间主内容区 -->
    <!-- ======================================================= -->
    <div class="doc-main-content">
      <article class="article  article--page  typeset">
        <h1>{{ page.title }}</h1>
        {{ content }}

        <nav class="doc-pagination">
          {% if documents_in_collection and documents_in_collection.size > 0 %}
            {% assign sorted_docs = documents_in_collection | sort: 'order' %}
            {% assign current_index = -1 %}
            
            {% for doc in sorted_docs %}
              {% if doc.url == page.url %}
                {% assign current_index = forloop.index0 %}
              {% endif %}
            {% endfor %}
            
            {% if current_index != -1 %}
              <!-- 上一页 -->
              {% if current_index > 0 %}
                {% assign prev_doc_index = current_index | minus: 1 %}
                {% assign prev_doc = sorted_docs[prev_doc_index] %}
                <a href="{{ prev_doc.url | relative_url }}" class="prev">&laquo; {{ prev_doc.title }}</a>
              {% else %}
                <span></span>
              {% endif %}
              
              <!-- 下一页 -->
              {% assign next_doc_index = current_index | plus: 1 %}
              {% if next_doc_index < sorted_docs.size %}
                {% assign next_doc = sorted_docs[next_doc_index] %}
                <a href="{{ next_doc.url | relative_url }}" class="next">{{ next_doc.title }} &raquo;</a>
              {% endif %}
            {% endif %}
          {% endif %}
        </nav>
      </article>
    </div>

    <!-- ======================================================= -->
    <!-- 右侧边栏 -->
    <!-- ======================================================= -->
<!-- ======================================================= -->
<!-- 右侧边栏 (已修正的纯 Liquid TOC) -->
<!-- ======================================================= -->
<aside class="doc-sidebar-right">
  {% if page.toc %}
    <nav class="doc-toc-nav">
      <h4>On This Page</h4>
      
      {% comment %}
        使用正则表达式从渲染后的 content 中精确捕获 h2 和 h3 标签的
        级别(level), ID, 和标题文本(title)。
        这是最可靠的纯 Liquid 方法。
      {% endcomment %}
      {% assign headings = content | scan: /<h([2-3])\s+id="([^"]+)"[^>]*>([\s\S]*?)<\/h[2-3]>/ %}
      
      {% if headings.size > 0 %}
        <ul class="toc-list">
          {% for heading in headings %}
            {% assign level = heading[0] %}
            {% assign id = heading[1] %}
            {% assign title = heading[2] | strip_html | strip %}
            <li class="toc-item">
              <a href="#{{ id }}" class="toc-link toc-level-{{ level }}">{{ title }}</a>
            </li>
          {% endfor %}
        </ul>
      {% endif %}
    </nav>
  {% endif %}
</aside>

  </div><!-- /.doc-layout -->
</main>

<!-- 4. 引入 AlbeMic 主题的页脚 -->
{% include site-footer.html %}

<!-- ======================================================================= -->
<!-- 5. 内联 JavaScript 脚本 -->
<!-- ======================================================================= -->
<script>
  // Vanilla Scrollspy v1.2.0 (minified)
  var VanillaScrollspy=function(){"use strict";var t={};return t.init=function(e){var n=e.menu,o=document.querySelectorAll(e.section),i=e.speed||500,s=e.easing||"linear",c=e.offset||0,l=e.activeClass||"active",a=e.onEnter||null,r=e.onLeave||null,u=0;n.addEventListener("click",function(t){t.preventDefault();var e=t.target;"a"===e.tagName.toLowerCase()&&(u=document.querySelector(e.hash).offsetTop-c,function t(e,n,o,i,s){var c=n-e,l=0,a=function(t){return t<.5?2*t*t:-1+(4-2*t)*t},r=function(t){return t<.5?4*t*t*t:.5*Math.pow(2*t-2,3)+1},u=function(n){switch(s){case"linear":l=n;break;case"easeInQuad":l=n*n;break;case"easeOutQuad":l=n*(2-n);break;case"easeInOutQuad":l=a(n);break;case"easeInCubic":l=n*n*n;break;case"easeOutCubic":l=--n*n*n+1;break;case"easeInOutCubic":l=r(n);break;case"easeInQuart":l=n*n*n*n;break;case"easeOutQuart":l=1- --n*n*n*n;break;case"easeInOutQuart":l=n<.5?8*n*n*n*n:1-8*--n*n*n*n;break;case"easeInQuint":l=n*n*n*n*n;break;case"easeOutQuint":l=1+--n*n*n*n*n;break;case"easeInOutQuint":l=n<.5?16*n*n*n*n*n:1+16*--n*n*n*n*n;break;default:l=n}return l*c+e};var d,f=null;window.requestAnimationFrame(function t(s){f||(f=s);var c=s-f,p=u(c/i);window.scrollTo(0,p),c<i&&window.requestAnimationFrame(t)})}(window.pageYOffset,u,0,i,s))});for(var d=0;d<n.querySelectorAll("a").length;d++)n.querySelectorAll("a")[d].classList.remove(l);var f=0,p=0;window.addEventListener("scroll",function(){for(var t=0;t<o.length;t++){var e=window.pageYOffset+c,i=o[t].offsetTop,s=i+o[t].offsetHeight,u=o[t].id;e>=i&&e<=s?(p=t,f!==p&&(null!==r&&r(o[f]),n.querySelector('a.active').classList.remove(l),f=p,n.querySelector('a[href="#'+u+'"]').classList.add(l),null!==a&&a(o[t]))):n.querySelector('a[href="#'+u+'"]').classList.remove(l)}})},t}();

  // Initialize Scrollspy
  document.addEventListener('DOMContentLoaded', function() {
    const tocMenu = document.querySelector('.doc-toc-nav');
    if (tocMenu) {
      const scrollSpy = new VanillaScrollspy({
        menu: tocMenu,
        section: document.querySelectorAll('.article h2, .article h3'),
        offset: 100,
        activeClass: 'is-active'
      });
      scrollSpy.init();
    }
  });
</script>