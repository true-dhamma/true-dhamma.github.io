---
layout: default
---

<!-- 1. 引入 AlbeMic 主题的页眉 -->
{% include site-header.html %}

<!-- CSS 样式 (保持不变) -->
<style>
  /* ... 这里是你之前的全部 CSS 代码，无需改动 ... */
  .doc-layout { display: grid; /* ... etc */ }
</style>

<!-- 
  =======================================================================
  动态获取当前 Collection 的内容
  - page.collection 的值会是 "buddhadhamma" 或 "yetanotherbook"
  - site[page.collection] 就可以动态地访问 site.buddhadhamma 或 site.yetanotherbook
  =======================================================================
-->
{% assign current_collection_name = page.collection %}
{% assign documents_in_collection = site[current_collection_name] %}

<main class="main  container">
  <div class="doc-layout">
    
    <!-- ======================================================= -->
    <!-- 左侧边栏 - 使用动态获取的 Collection -->
    <!-- ======================================================= -->
    <aside class="doc-sidebar-left">
      <nav class="doc-chapters-nav">
        <!-- 动态显示 Collection 的标题，如果在 _config.yml 中定义了 -->
        <h3>{{ site.collections[current_collection_name].title | default: current_collection_name | capitalize }}</h3>
        
        {% if documents_in_collection and documents_in_collection.size > 0 %}
          <ul>
            {% assign sorted_docs = documents_in_collection | sort: 'order' %}
            {% for doc in sorted_docs %}
              <li {% if page.url == doc.url %}class="active"{% endif %}>
                <a href="{{ doc.url | relative_url }}">{{ doc.title }}</a>
              </li>
            {% endfor %}
          </ul>
        {% endif %}
      </nav>
    </aside>

    <!-- ======================================================= -->
    <!-- 中间主内容区 - 使用动态获取的 Collection -->
    <!-- ======================================================= -->
    <div class="doc-main-content">
      <article class="article  article--page  typeset">
        <h1>{{ page.title }}</h1>
        {{ content }}

        <nav class="doc-pagination">
          {% if documents_in_collection and documents_in_collection.size > 0 %}
            {% assign sorted_docs = documents_in_collection | sort: 'order' %}
            {% assign current_index = -1 %}
            
            {% for doc in sorted_docs %}
              {% if doc.url == page.url %}
                {% assign current_index = forloop.index0 %}
              {% endif %}
            {% endfor %}
            
            {% if current_index != -1 %}
              <!-- 上一页 -->
              {% if current_index > 0 %}
                {% assign prev_doc_index = current_index | minus: 1 %}
                {% assign prev_doc = sorted_docs[prev_doc_index] %}
                <a href="{{ prev_doc.url | relative_url }}" class="prev">&laquo; {{ prev_doc.title }}</a>
              {% else %}
                <span></span>
              {% endif %}
              
              <!-- 下一页 -->
              {% assign next_doc_index = current_index | plus: 1 %}
              {% if next_doc_index < sorted_docs.size %}
                {% assign next_doc = sorted_docs[next_doc_index] %}
                <a href="{{ next_doc.url | relative_url }}" class="next">{{ next_doc.title }} &raquo;</a>
              {% endif %}
            {% endif %}
          {% endif %}
        </nav>
      </article>
    </div>

    <!-- 右侧边栏 (保持不变) -->
    <aside class="doc-sidebar-right">
      {% if page.toc %}
        <nav class="doc-toc-nav">
          <h4>On This Page</h4>
          {{ content | toc_generate }}
        </nav>
      {% endif %}
    </aside>

  </div>
</main>

<!-- 4. 引入 AlbeMic 主题的页脚 -->
{% include site-footer.html %}

<!-- 5. 内联 JavaScript 脚本 (保持不变) -->
<script>
  /* ... 这里是你之前的全部 JS 代码，无需改动 ... */
</script>